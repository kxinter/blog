---
title: vsftp示例1
tags:
  - ftp
categories:
  - Linux
copyright: true
date: 2019-01-21 11:08:17
---

# 1 部署要求
在**阿里云**服务器上部署FTP.
服务要求：FTP用户A、B可互相访问，A对B有写权限，B对A只有读权限。
<!--more-->
# 2 步骤
## 2.1 安装vsftpd

``` bash
yum install -y vsftpd
```
## 2.2 修改配置文件

``` dsconfig
vim /etc/vsftpd/vsftpd.conf

配置如下：
anonymous_enable=NO
chroot_local_user=YES
chroot_list_enable=NO
chroot_list_file=/etc/vsftpd/chroot_list
local_root=/home/vsftpd
allow_writeable_chroot=YES

pasv_enable=YES
pasv_min_port=8022
pasv_max_port=8030
pasv_promiscuous=YES
```
## 2.3 创建FTP根目录

``` bash
mkdir -p /home/vsftpd
```
## 2.4 创建系统用户

``` bash
useradd ftpsg -d /home/vsftpd/ftpsg
useradd ftpxc -d /home/vsftpd/ftpxc -g ftpsg
```
{%note danger %}**警告：**
1、创建用户必须赋予登陆权限，不可使用useradd vsftpd -d /home/vsftpd **-s /bin/false** 禁用登陆；
2、两个用户在一个用户组里面，后面分配权限更安全。
{%endnote%}
## 2.5 修改目录权限

``` bash
chmod 770 /home/ftpsg
chmod 750 /home/ftpxc
```
{%note info %}**信息：**
通过设置目录权限，达到限制用户权限的目的。ftpxc用户可读写ftpsg目录，ftpsg用户可读不可写ftpxc目录，其他用户无法访问2个目录。
备注：同时设置r-x权限，才可以访问目录。
{%endnote%}

# 3 FTP客户端访问
使用FileZilla客户端访问FTP服务器，出现如下问题

> 状态:    连接建立，等待欢迎消息... 
状态:    已登录 
状态:    读取目录列表... 
状态:    服务器发回了不可路由的地址。使用服务器地址代替

编辑-设置
![1](1.png)
{%note info %}**注释：**
因阿里云服务器事vps环境，访问FTP服务器，服务器返回的是内网地址，客户端无法连接；使用主动模式，可以直接通过互联网地址访问FTP。
{%endnote%}


# 4 参考资料
重要!!!
讲解一个重要配置组合。
![2](2.jpg)
[vsftp 实现不同用户不同权限配置](https://www.cnblogs.com/ldl1137/p/7102694.html)