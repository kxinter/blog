---
title: 编辑rc.local启动命令执行不成功处理
tags:
  - 基础运维
  - 运维开发
  - tomcat
categories:
  - Linux
date: 2018-08-23 16:26:31
copyright: true
---

# 1 问题举例：
<!--more-->
rc.local内容如下

``` bash
#!/bin/bash
# THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES
#
# It is highly advisable to create own systemd services or udev rules
# to run scripts during boot instead of using this file.
#
# In contrast to previous versions due to parallel execution during boot
# this script will NOT be run after all other services.
#
# Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure
# that this script will be executed during boot.

touch /var/lock/subsys/local
mount -t cifs -o username=backup,password=xxxxxxx //192.168.1.170/192.168.1.11/ /mnt/backup_data/
/usr/local/tomcat/bin/startup.sh
```
挂载命令执行了，但tomcat没有启动

# 2 问题原因及处理方法

## 2.1 原因

因java使用的是解压缩版，在/etc/profile内添加java的环境变量，系统启动时先执行的是rc.local,因此tomcat启动失败

## 2.2 解决办法

### 2.2.1 方法1

在rc.local内添加java的环境变量命令（必须放在tomcat启动命令前）

``` bash
export JAVA_HOME=/usr/local/java/jdk1.6.0_18
export JRE_HOME=/usr/local/java/jdk1.6.0_18/jre
```

### 2.2.2 方法2

在tomcat的启动脚本内添加java路径
分别在tomcat_home/bin目录内的catalina.sh ，setclasspath.sh脚本前面指定JAVA_HOME路径

``` bash
export JAVA_HOME=/usr/local/java/jdk1.6.0_18
export JRE_HOME=/usr/local/java/jdk1.6.0_18/jre
```
